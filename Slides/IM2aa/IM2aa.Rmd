---
title: "IM, deux ans après"
author: "Antoine Bichat<br>Lundi 12 mars 2018"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    css: ["./IM2aa.css", "default-fonts"]
---

```{r setup, include=FALSE, warning=FALSE}
options(htmltools.dir.version = FALSE, dev = 'pdf')
library(leaflet)
library(ggplot2)
```

# Mini CV

.pull-left[

* Secondaire en région Lyonnaise
 
* MP* et 5/2 au Lycée du Parc

* Intégration en 2014

* IM

* 3A hors école en Biomathématiques

* Thèse en Biostatistique

]

.pull-right[

```{r photoab, fig.align="center", out.width="70%", echo=FALSE}
knitr::include_graphics("photo_ab.jpg")
```
]

---
class: center, middle

# Mines Nancy

```{r logomines, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_mines_noir.png")
```

---
## Vie à Mines Nancy

<div style = "margin-top: -20px"></div>

* Les assos

<center>
<img src="logo_feh.png" height="110"> &nbsp;&nbsp;&nbsp;  <img src="logo_minestank.png" height="100"> &nbsp;&nbsp;&nbsp;  <img src="logo_rdd.png" height="120"> &nbsp;&nbsp;&nbsp;  <img src="logo_jtm.png" height="100">
</center>

<ul>
<ul>
<li><p>Délégué</p></li>
<li><p>Elève Administrateur</p></li>
</ul>
</ul>

--

* Ingénierie Mathématique

* Mineure Biologie 

* Parcours Recherche

--

* Voeux de 3A hors-école
  
  * _Mathématques de la modélisation_, UPMC 
  
  * _Mathématiques pour les sciences du vivant_, Saclay

---
class: center, middle

# Enterome
```{r logoenterome, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_enterome.png")
```



---
## La société

* Laboratoire pharmaceutique

  * spécialisé dans les maladies relatives au microbiote intestinal (maladies inflammatoires, cancers, ulcères, ...)
  
  * développe des médicaments et des biomarqueurs 
  
<br>

* 40 salariés dont 20 sur le site parisien 

  * $\pm$ 6 personnes dans l'équipe bioinfo-biostat

<br>

* Financement par levées de fonds (32 M€ en 2018) et prestations scientifiques



---
## Stage d'assistant ingénieur

* Trouvé sur le site de la <a href="https://www.sfbi.fr" target="_blank">Société Française de BioInformatique</a>

<br>

* Automatisation d'un rapport de contrôle qualité en R

<br>

--

* Apports :

  * Utilisation de R 
  
  * Interaction avec des informaticiens, biologistes, medecins, ...
  
  * Proposition de thèse

---
class: center, middle

# Le microbiote
```{r gutmic, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("gutmic.png")
```

---
## Qu'est-ce que c'est ?

```{r publi, echo=FALSE}
dfpubli <- 
  data.frame(
    Year = 1990:2017,
    Number = c(727, 748, 844, 782, 918,1030, 1220, 1500, 1900, 2400, 
               2920, 3230, 3940, 4460, 5660, 7100, 8440, 10600, 12600, 15300, 
               18600, 23600, 31200, 39100, 46900, 52300, 52500, 44500)
  )
p <-
  ggplot(dfpubli, aes(Year, Number/1000)) + 
  geom_col() + 
  theme_minimal() +
  scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
  labs(x = "Année de publication", y = "Nombre (milliers)",
       title = "Articles contenant 'Microbiome' ou 'Microbiota'",
       caption = "Source : Google Scholar") +
  # coord_fixed(ratio = 0.3) +
  theme(axis.text = element_text(size = 13), axis.title = element_text(size = 15), 
        plot.title = element_text(size = 17), plot.caption = element_text(size = 13))
```


* Le **microbiote** est l'ensemble des individus présents dans un environnement donné

* Le **métagénome** (**microbiome** en englais) est l'ensemble des génomes du microbiote 

* La **métagénomique** est l'étude du microbiome via séquençage direct

--

<!-- <div style = "margin-top: -30px"></div> -->

```{r plotpubli, echo=FALSE, fig.width=7, fig.height=3, fig.align='center', dpi=300}
print(p)
```



---
class: center, middle

# UPMC

```{r logoupmc, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_upmc.png")
```

---
## Une université dans Paris

```{r, out.width='100%', fig.height=6, echo=FALSE, warning=FALSE}
leaflet() %>% addTiles() %>% setView(2.35654, 48.847125, zoom = 15)
```

---
# Quelques chiffres

* 32 000 étudiants 

* 4 500 enseignants-chercheurs et chercheurs

* 125 laboratoires de recherche

* 6 parcours de M2 de mathématiques différents :

 * Mathématiques Fondamentales
 * Probabilités et Modèles Aléatoires
 * Probabilités et Finances
 * __Mathématiques de la Modélisation__
 * Ingénierie Mathématique
 * Statistique
 * Préparation à l'Agrégation
 

---
## Nouvelle identité

* Sorbonne Université depuis le 1er janvier 2018

* 53 400 étudiants

<br>

```{r logosorbonne, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_sorbonne.svg")
```


---
class: center, middle

# Nestlé Research Center
```{r logonestler, fig.align="center", out.width="50%", echo=FALSE}
knitr::include_graphics("logo_nestler.jpg")
```

---
class: center, middle

# Thèse CIFRE

```{r logocifre, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_cifre.jpg")
```

---
# Le dispositif

---
class: center, middle

# LaMME

```{r logolamme, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_lamme.svg")
```

---
## Le laboratoire

* Hébergé à l'Institut de Biologie, de Génomique et de BioInformatique 

* 3 équipes de recherche :

  * Analyse et Equations aux Dérivées Partielles
  * Probabilités et Mathématiques Financières
  * __Statistique et Génome__


---
class: center, middle

# Enterome, le retour
```{r logoenteromebis, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_enterome.png")
```



---
class: center, middle

# p-valeur
```{r pval, fig.align="center", out.width="40%", echo=FALSE, fig.cap='From <a href="https://xkcd.com" target="_blank">xkcd</a>'}
knitr::include_graphics("pvaluexkcd.jpg")
```

---
## Définition et utilisation

Soit $H_0$ une hypothèse nulle et $X$ une série d'observations.

$$p = \mathbb{P}\left(X\mid H_0\right)$$

--

$p$ mesure la probabilité d'obtenir un résultat "au moins aussi extrême" que celui observé "sachant l'hypothèse nulle".

<br>
--

Extension du raisonnement par l'absurde : on rejette $H_0$ dans le cas où les observations sont hautement improbables ( $p<0.05$ ).


<br>
--

Sous l'hypothèse nulle, $p\sim\mathcal{U}\left([0,1]\right)$, donc avec un seuil $\alpha = 0.05$, on a 5% de chance de faire une "fausse découverte".


<br>
--

.center[
`r icon::fa_exclamation_triangle()` $p \neq \mathbb{P}\left(H_0\mid X\right)$
]

---
## Exemple visuel

La p-valeur peut être obtenue par comparaison avec un score de référence.

```{r mc, echo=FALSE, fig.align='center', dpi=200}
knitr::include_graphics("mc3-1.png")
```

---
## Problème des tests multiples

Si l'on teste $m$ hypothèses, quelle est la probabilité de faire au moins une fausse découverte ?

--

Soit $A_i = \left\{A_i\text{ est vraie}\right\} \bigcup \left\{p_i< \alpha\right\}$. On a $\mathbb{P}\left(A_i\right) = \alpha$.

--

$$\mathbb{P}\left(\bigcup_{i=1}^m A_i\right) = 1- \mathbb{P}\left(\overline{\bigcup_{i=1}^m A_i}\right) = 1- \mathbb{P}\left(\bigcap_{i=1}^m \overline{A_i}\right) = 1- \mathbb{P}\left( \overline{A_i}\right)^m = 1- \left( 1-\alpha\right)^m$$

--

```{r dfpval, echo=FALSE, fig.height=3.2, fig.align='center', dpi=300}
dfpval <- data.frame(n <- 1:15, p = 1-(1-0.05)^n)
ggplot(dfpval, aes(n,p)) + 
  geom_line(size = 1, alpha = 0.5) +
  geom_point(size = 3) + 
  scale_x_continuous(breaks = seq(2, 15, 2)) +
  scale_y_continuous(limits = c(0, 0.6)) +
  theme_minimal() +
  theme(axis.text = element_text(size = 13), axis.title = element_text(size = 13), 
        plot.title = element_text(size = 17), plot.caption = element_text(size = 10)) +
  labs(x = "Nombre d'hypothèses à tester", y = "Probabilité d'avoir au moins un FP")
```

---
class: center, middle, inverse

# Merci pour votre attention !

#### `r icon::fa("github", size = 1)` <a href="https://github.com/abichat" target="_blank">@abichat</a>
<div style = "margin-top: -20px"></div>
#### `r icon::fa("linkedin-square", size = 1)` <a href="https://www.linkedin.com/in/antoinebichat" target="_blank">antoinebichat</a>
<div style = "margin-top: -20px"></div>
#### `r icon::fa("link", size = 1)` <a href="https://abichat.github.io" target="_blank">abichat.github.io</a>
<div style = "margin-top: -20px"></div>
####`r icon::fa("envelope", size = 1)` <a href="mailto:antoine.bichat@mines-nancy.org?subject=Science%20Communication%20with%20R">antoine.bichat@mines-nancy.org</a>


.footnote[Slides created via the R package <b><a href="https://github.com/yihui/xaringan" target="_blank">xaringan</a></b>.]
