---
title: "IM, deux ans apr√®s"
author: "Antoine Bichat<br>Lundi 12 mars 2018"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    css: ["./IM2aa.css", "default-fonts"]
---

```{r setup, include=FALSE, warning=FALSE}
options(htmltools.dir.version = FALSE, dev = 'pdf')
library(leaflet)
library(ggplot2)
```

# Mini CV

.pull-left[

* Secondaire en r√©gion Lyonnaise
 
* MP* et 5/2 au Lyc√©e du Parc

* Int√©gration en 2014

* IM

* 3A hors √©cole en Biomath√©matiques

* Th√®se en Biostatistique

]

.pull-right[

```{r photoab, fig.align="center", out.width="70%", echo=FALSE}
knitr::include_graphics("photo_ab.jpg")
```
]

---
class: center, middle

# Mines Nancy

```{r logomines, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_mines_noir.png")
```

---
## Vie √† Mines Nancy

<div style = "margin-top: -20px"></div>

* Les assos

<center>
<img src="logo_feh.png" height="110"> &nbsp;&nbsp;&nbsp;  <img src="logo_minestank.png" height="100"> &nbsp;&nbsp;&nbsp;  <img src="logo_rdd.png" height="120"> &nbsp;&nbsp;&nbsp;  <img src="logo_jtm.png" height="100">
</center>

<ul>
<ul>
<li><p>D√©l√©gu√©</p></li>
<li><p>El√®ve Administrateur</p></li>
</ul>
</ul>

--

* Ing√©nierie Math√©matique

* Mineure Biologie 

* Parcours Recherche

--

* Voeux de 3A hors-√©cole
  
  * _Math√©matques de la mod√©lisation_, UPMC 
  
  * _Math√©matiques pour les sciences du vivant_, Saclay

---
class: center, middle

# Enterome
```{r logoenterome, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_enterome.png")
```



---
## La soci√©t√©

* Laboratoire pharmaceutique

  * sp√©cialis√© dans les maladies relatives au microbiote intestinal (maladies inflammatoires, cancers, ulc√®res, ...)
  
  * d√©veloppe des m√©dicaments et des biomarqueurs 
  
<br>

* 40 salari√©s dont 20 sur le site parisien 

  * $\pm$ 6 personnes dans l'√©quipe bioinfo-biostat

<br>

* Financement par lev√©es de fonds (32 M‚Ç¨ en 2018) et prestations scientifiques



---
## Stage d'assistant ing√©nieur

* Trouv√© sur le site de la <a href="https://www.sfbi.fr" target="_blank">Soci√©t√© Fran√ßaise de BioInformatique</a>

<br>

* Automatisation d'un rapport de contr√¥le qualit√© en R

<br>

--

* Apports :

  * Utilisation de R 
  
  * Interaction avec des informaticiens, biologistes, medecins, ...
  
  * Proposition de th√®se

---
class: center, middle

# Le microbiote
```{r gutmic, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("gutmic.png")
```

---
## Qu'est-ce que c'est ?

```{r publi, echo=FALSE}
dfpubli <- 
  data.frame(
    Year = 1990:2017,
    Number = c(727, 748, 844, 782, 918,1030, 1220, 1500, 1900, 2400, 
               2920, 3230, 3940, 4460, 5660, 7100, 8440, 10600, 12600, 15300, 
               18600, 23600, 31200, 39100, 46900, 52300, 52500, 44500)
  )
p <-
  ggplot(dfpubli, aes(Year, Number/1000)) + 
  geom_col(fill = "grey50", color = "black") + 
  theme_minimal() +
  scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
  labs(x = "Ann√©e de publication", y = "Nombre (milliers)",
       title = "Articles contenant 'Microbiome' ou 'Microbiota'",
       caption = "Source : Google Scholar") +
  # coord_fixed(ratio = 0.3) +
  theme(axis.text = element_text(size = 13), axis.title = element_text(size = 15), 
        plot.title = element_text(size = 17), plot.caption = element_text(size = 13))
```


* Le **microbiote** est l'ensemble des individus pr√©sents dans un environnement donn√©

* Le **m√©tag√©nome** (**microbiome** en englais) est l'ensemble des g√©nomes du microbiote 

* La **m√©tag√©nomique** est l'√©tude du microbiome via s√©quen√ßage direct

--

<!-- <div style = "margin-top: -30px"></div> -->

```{r plotpubli, echo=FALSE, fig.width=7, fig.height=3, fig.align='center', dpi=300}
print(p)
```

---
## Quelques chiffres

* 100 000 milliards de micro-organismes

* 600 000 g√®nes (contre 23 000 chez l'homme)

* 200 esp√®ces diff√©rentes

* 2 kilos

--

<br>

Un organe √† part enti√®re ? 
---
## Interaction h√¥te-microbiome

* Syst√®me immunitaire et allergies

--

* R√©ponse au stress

--

*  R√©sistance √† l'alcool

--

* Contr√¥le du fer 

--

* Pr√©f√©rences sexuelles

---
## Comment l'analyser ?

<br>

Pr√©sentation  <a href="https://abichat.github.io/Slides/MetagenomicsRGrenoble/MetagenomicsRGrenoble" target="_blank"><i>Metagenomics with R</i></a> √† <a href="https://r-in-grenoble.github.io" target="_blank">R Users Grenoble</a>



---
class: center, middle

# UPMC

```{r logoupmc, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_upmc.png")
```

---
## Une universit√© dans Paris

```{r, out.width='100%', fig.height=6, echo=FALSE, warning=FALSE}
leaflet() %>% addTiles() %>% setView(2.35654, 48.847125, zoom = 15)
```

---
## Quelques chiffres

* 32 000 √©tudiants 

* 4 500 enseignants-chercheurs et chercheurs

* 125 laboratoires de recherche

* 6 parcours de M2 de math√©matiques diff√©rents :

 * Math√©matiques Fondamentales
 * Probabilit√©s et Mod√®les Al√©atoires
 * Probabilit√©s et Finances
 * __Math√©matiques de la Mod√©lisation__
 * Ing√©nierie Math√©matique
 * Statistique
 * Pr√©paration √† l'Agr√©gation
 

---
## Nouvelle identit√©

* Sorbonne Universit√© depuis le 1er janvier 2018

* 53 400 √©tudiants

<br>

```{r logosorbonne, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_sorbonne.svg")
```

---
## Ma formation

<div style = "margin-top: -30px"></div>

* __Math√©matiques pour les Sciences Biologiques et M√©dicales__

  * Equations aux d√©riv√©es partielles
  * M√©thodes num√©riques pour les EDP instationnaires
  * Processus de Markov, application √† la dynamique des populations 
  * Calcul stochastique
  
--

<ul>
<ul>
<li>M√©thodes math√©matiques pour la biologie</li>
<li>M√©thodes num√©riques probabilistes</li>
<li>Statistique et apprentissage</li>
</ul>
</ul>

--

<ul>
<ul>
<li>M√©thodes probabilistes en neurosciences</li>
<li>Mod√©lisation de la r√©sistance des bact√©ries aux antibiotiques</li>
</ul>
</ul>

--

* __Certificat Big Data__

  * Apprentissage statistique
  * Outils pour l'apprentissage statistique distribu√©
  * Big data et applications

--

<ul>
<ul>
<li>Statistique et apprentissage</li>
<li>Apprentissage en grande dimension</li>
<li>Analyse statistique de graphes</li>
</ul>
</ul>


---
## Ce qui change

* Les effectifs

--

* Les cours √† la carte

--

* Les interactions avec les autres √©l√®ves

--

* Les interactions avec les enseignants

--

* Les supports p√©dagogiques

--

* La BU

---
class: center, middle

# Nestl√© Research Center
```{r logonestler, fig.align="center", out.width="50%", echo=FALSE}
knitr::include_graphics("logo_nestler.jpg")
```

---
## Nestl√©

--

.pull-left[
<br>
```{r brands, fig.align="center", out.width="100%", echo=FALSE}
knitr::include_graphics("nestle_brands.jpg")
```
]

--

.pull-right[
```{r dfaa, fig.align="center", out.width="100%", echo=FALSE, dpi=300}
dfaa <- data.frame(Entreprise = factor(c("Nestl√©", "Unilever", "PepsiCo", "The Coco-Cola Company", "Danone", "Mondelez"), 
                                           levels = c("Nestl√©", "Unilever", "PepsiCo", "The Coco-Cola Company", "Danone", "Mondelez")),
                   Pays = c("Suisse", "Royaume-Uni/Pays-Bas", "Etats-Unis", "Etats-Unis", "France", "Etats-Unis"),
                   CA = c(95.6, 66.3, 63.5, 35.4, 30.5, 25.6))
ggplot(dfaa, aes(Entreprise, CA, fill = Pays)) +
  geom_col() +
  geom_label(aes(y = CA/2, label = CA), alpha = 0.3, fill = "white") +
  scale_x_discrete(breaks = c("Nestl√©", "Unilever", "PepsiCo", "The Coco-Cola Company", "Danone", "Mondelez")) +
  # scale_fill_manual(values = c("red", "blue", "grey", "purple")) +
  theme_minimal() +
  labs(x = NULL, y = "Chiffre d'affaires (en milliards de $)") +
  theme(axis.text = element_text(size = 13), axis.title = element_text(size = 13),
        plot.title = element_text(size = 17), plot.caption = element_text(size = 10), 
        axis.text.x = element_text(angle = 20, hjust = 1),
        legend.position = "top")
```
]

--


* 335 000 employ√©s dont 5 000 en R&D

* 436 usines dans 86 pays



---
## Le centre de recherche de Vers-Chez-Les-Blancs

* Intitute of Food Safety & Analytical Science

* Intitute of Material Science

* __Intitute of Nutritional Science__

--

  * Department of Cognitive Development
  
  * Department of Dietary Recommendations
  
  * Department of Metabolic Health
  
  * __Department of Gut Ecosystem__
  
--

<ul>
<ul>
<ul>
<li><p>Gatrointestinal Physiology</p></li>
<li><p>Immunology</p></li>
<li><p><b>Host-Microbe Interaction<b></p></li>
</ul>
</ul>
</ul>

---
## Le stage


* Trouv√© gr√¢ce √† un contact d'Enterome

--

* Missions principales :

  * Analyse exploratoire et visualisation de donn√©es

  * Nouveau pipeline

  * Influence du r√©gime alimentaire

--

* Apports :

  * Connaissances en microbiote
  
  * Programmation R
  
  * Anglais
  
  * Interaction avec des biologistes, nutritionistes, virologues, ...
  
  
---
## Quelques r√©sultats

<!-- Inclure incfluence CS vs VD -->


---
## La Suisse üá®üá≠




---
class: center, middle

# Th√®se CIFRE

```{r logocifre, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_cifre.jpg")
```

---
## Le dispositif


---
## Quelques chiffres



---
class: center, middle

# Enterome, le retour
```{r logoenteromebis, fig.align="center", out.width="40%", echo=FALSE}
knitr::include_graphics("logo_enterome.png")
```


---
## Ma th√®se

> Prise en compte de l‚Äôorganisation hi√©rarchique des esp√®ces pour la d√©couverte de signatures m√©tag√©nomiques multi-√©chelles.

--

<br>

1. Directeur de th√®se (Universit√© d'√âvry - LaMME - AgroParisTech)

2. Co-directeur de th√®se (INRA)

3. Co-encadrant de th√®se (Enterome)

---
## Process Com 

* Mod√®le de compr√©hension des personnalit√©s pour d√©velopper des strat√©gies de communication adapt√©es.

* La mani√®re de dire les choses a autant, et parfois plus, d'importance que ce qui est dit.

--

* Six types de profil :

  * __Empathique__ (chaleureux, sensible, compatissant)

  * __Travaillomane__ (logique, organis√©, responsable)
  
  * Pers√©v√©rant (d√©vou√©, consciencieux, observateur)
  
  * R√™veur (calme, imaginatif, r√©fl√©chi)
  
  * Promoteur (adaptable, charmeur, plein de ressources)
  
  * Rebelle (cr√©atif, ludique, spontan√©)
  
  
---
class: center, middle

# LaMME

```{r logolamme, fig.align="center", out.width="30%", echo=FALSE}
knitr::include_graphics("logo_lamme.svg")
```


---
## Le laboratoire

* H√©berg√© √† l'Institut de Biologie, de G√©nomique et de BioInformatique 

* 3 √©quipes de recherche :

  * Analyse et Equations aux D√©riv√©es Partielles
  * Probabilit√©s et Math√©matiques Financi√®res
  * __Statistique et G√©nome__

--

Le premier mercredi du mois : s√©minaire _Maths for Genomics_ 

--

```{r ibgbi, fig.align="center", out.width="55%", echo=FALSE}
knitr::include_graphics("ibgbi.jpg")
```

---
class: center, middle

# p-valeur
```{r pval, fig.align="center", out.width="40%", echo=FALSE, fig.cap='From <a href="https://xkcd.com" target="_blank">xkcd</a>'}
knitr::include_graphics("pvaluexkcd.jpg")
```

---
## D√©finition et utilisation

Soit $H_0$ une hypoth√®se nulle et $X$ une s√©rie d'observations.

$$p = \mathbb{P}\left(X\mid H_0\right)$$

--

$p$ mesure la probabilit√© d'obtenir un r√©sultat "au moins aussi extr√™me" que celui observ√© "sachant l'hypoth√®se nulle".

<br>

--

Extension du raisonnement par l'absurde : on rejette $H_0$ dans le cas o√π les observations sont hautement improbables $(p<0.05)$.


<br>

--

Sous l'hypoth√®se nulle, $p\sim\mathcal{U}\left([0,1]\right)$, donc avec un seuil $\alpha = 0.05$, on a 5% de chance de faire une "fausse d√©couverte" (faux positif).


<br>

--

.center[
‚ö†Ô∏è $p \neq \mathbb{P}\left(H_0\mid X\right)$ ‚ö†Ô∏è
]

---
## Exemple

La p-valeur peut √™tre obtenue par comparaison avec un score de r√©f√©rence.

```{r mc, echo=FALSE, fig.align='center', dpi=200}
knitr::include_graphics("mc3-1.png")
```

---
## Probl√®me des tests multiples

Si l'on teste $m$ hypoth√®ses, quelle est la probabilit√© de faire au moins une fausse d√©couverte ?

--

Soit $A_i = \left\{H_{0,i}\text{ est vraie}\right\} \bigcap \left\{p_i< \alpha\right\}$. On a $\mathbb{P}\left(A_i\right) = \alpha$.

--

$$\mathbb{P}\left(\bigcup_{i=1}^m A_i\right) = 1- \mathbb{P}\left(\overline{\bigcup_{i=1}^m A_i}\right) = 1- \mathbb{P}\left(\bigcap_{i=1}^m \overline{A_i}\right) \doteq 1- \mathbb{P}\left( \overline{A_i}\right)^m = 1- \left( 1-\alpha\right)^m$$

--

```{r dfpval, echo=FALSE, fig.height=3, fig.align='center', dpi=300}
dfpval <- data.frame(n <- 1:15, p = 1-(1-0.05)^n)
ggplot(dfpval, aes(n,p)) + 
  geom_line(size = 1, alpha = 0.5) +
  geom_point(size = 3) + 
  scale_x_continuous(breaks = seq(2, 15, 2)) +
  scale_y_continuous(limits = c(0, 0.6)) +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 12), 
        plot.title = element_text(size = 17), plot.caption = element_text(size = 10)) +
  labs(x = "Nombre d'hypoth√®ses √† tester", y = "Probabilit√© d'avoir au moins un FP")
```

---
## Correction de Bonferroni

Au lieu de rejeter avec un seuil $\alpha$, on va rejeter √† un seuil $\frac{\alpha}{m}$.

$$\mathbb{P}\left(\bigcup_{i=1}^m A_i\right) \leq \sum_{i=1}^m \mathbb{P}\left(A_i\right)=\sum_{i=1}^m \frac{\alpha}{m} = \alpha$$

--


Mais on ne s'autorise qu'une seule erreur, quelque soit le nombre d'hypoth√®ses.

Proc√©dure tr√®s conservative üòï

---
## Correction FDR (_False Discovery Rate_)

On s'autorise un certain pourcentage de fausses d√©couvertes parmi nos d√©couvertes : on cherche √† contr√¥ler la quantit√©

$$\mathbb{E}\left[\frac{\text{nombre de fausses d√©couvertes}}{\text{nombre de d√©couvertes}}\right].$$

--

__Proc√©dure__ :

1. Ordonner les p-valeurs $(p_{(1)} \leq p_{(2)} \leq \ldots \leq p_{(m)})$ en notant $p_{(0)}=0$.

2. Poser $\hat{\ell} = \max\left\{\ell \in \{0, 1, \ldots, m\} : p_{(\ell)}\leq \frac{\alpha \ell}{m} \right\}$.

3. Rejeter les $\hat{\ell}$ hypoth√®ses ayant les plus petites p-valeurs.

--

<br>

.center[
<a href="https://roquain.shinyapps.io/FDR_tutorial/" target="_blank">Application Shiny d'√âtienne Roquain</a>
]

---
class: center, middle, inverse

# Merci pour votre attention !

#### `r icon::fa("github", size = 1)` <a href="https://github.com/abichat" target="_blank">@abichat</a>
<div style = "margin-top: -20px"></div>
#### `r icon::fa("linkedin-square", size = 1)` <a href="https://www.linkedin.com/in/antoinebichat" target="_blank">antoinebichat</a>
<div style = "margin-top: -20px"></div>
#### `r icon::fa("link", size = 1)` <a href="https://abichat.github.io" target="_blank">abichat.github.io</a>
<div style = "margin-top: -20px"></div>
####`r icon::fa("envelope", size = 1)` <a href="mailto:antoine.bichat@mines-nancy.org?subject=Science%20Communication%20with%20R">antoine.bichat@mines-nancy.org</a>


.footnote[Slides created via the R package <b><a href="https://github.com/yihui/xaringan" target="_blank">xaringan</a></b>.]
