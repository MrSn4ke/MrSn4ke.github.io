<!DOCTYPE html>
<html>
  <head>
    <title>Modeling in the Tidyverse</title>
    <meta charset="utf-8">
    <meta name="author" content="Antoine Bichat" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="sotr.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: title-slide, center, middle
count: false



&lt;br&gt;&lt;br&gt;&lt;br&gt;

# Modeling in the Tidyverse

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

### Antoine Bichat
&lt;div style = "margin-top: -30px"&gt;&lt;/div&gt;
### November 23, 2018 - AgroParisTech

---
class: center, middle, inverse

&lt;br&gt;
# Tidyverse

&lt;img src="img/hex-tidyverse.png", width=270&gt; 

---
## Metapackage


```r
library(tidyverse)
```

```
  ── Attaching packages ──────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──
```

```
  ✔ ggplot2 3.1.0     ✔ purrr   0.2.5
  ✔ tibble  1.4.2     ✔ dplyr   0.7.8
  ✔ tidyr   0.8.2     ✔ stringr 1.3.1
  ✔ readr   1.1.1     ✔ forcats 0.3.0
```

```
  ── Conflicts ─────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
  ✖ dplyr::filter() masks stats::filter()
  ✖ dplyr::lag()    masks stats::lag()
```

.footnote[<i class="fas  fa-clone "></i> See previous presentation &lt;a href="https://abichat.github.io/Slides/IntroTidyverseSOTR/IntroTidyverseSOTR.html#1" target="_blank"&gt;Introduction to the Tidyverse&lt;/a&gt;.]

--

&lt;br&gt;


```r
theme_set(theme_minimal())
```




---
## Data analysis pipeline

&lt;br&gt;

&lt;center&gt;
  &lt;img src="img/data-science-pipeline.png", height=250&gt; 
&lt;/center&gt;

.footnote[&lt;a href="https://r4ds.had.co.nz" target="_blank"&gt;<i class="fas  fa-book "></i> R for data science (G. Grolemund &amp; H. Wickham)&lt;/a&gt;]

---
class: center, middle, inverse

&lt;br&gt;
# Dplyr

&lt;img src="img/hex-dplyr.png", width=270&gt; 

---
## List of dplyr's useful functions

.pull-left[

* `mutate()`

* `rename()`

* `select()`

* `arrange()`, `arrange(desc())`

&lt;br&gt;

* `pull()`

&lt;br&gt;

* `filter()`

* `distinct()`

* `top_n()`

* `sample_n()`, `sample_frac()`
]

--

.pull-right[

* `*_if()`, `*_at()`, `*_all()`

&lt;br&gt;

* `*_join()`

&lt;br&gt;

* `group_by()`

* `summarise()`

&lt;br&gt;

* `first()`, `last()`, `nth()`

* `n()`, `n_distinct()`

&lt;br&gt;

* `row_numbers()`

* `lead()`, `lag()`, `cummean()` ...
]

---
class: center, middle, inverse

&lt;br&gt;
# Tidyr

&lt;img src="img/hex-tidyr.png", width=270&gt; 


---

## List of tidyr's useful functions

.pull-left[
* `spread()` &amp; `gather()`

* `separate()` &amp; `unite()`

* `nest()` &amp; `unnest()`

* `fill()`
]

--

.pull-right[
&lt;img src="img/tidyr-spread-gather.gif", width=400&gt; 
]

.footnote[&lt;a href="https://github.com/gadenbuie/tidyexplain" target="_blank"&gt;<i class="fab  fa-github "></i> Animations of tidyverse verbs (G. Aden-Buie)&lt;/a&gt;]


---
class: center, middle, inverse

&lt;br&gt;
# Purrr

&lt;img src="img/hex-purrr.png", width=270&gt; 

---
## Functionnal programming

* Never use `for` loops

--

&lt;br&gt;

* Forget all `*apply()` functions and friends for lists and dataframes

  * `apply`, `lapply()`, `sapply()`, `tapply()`, `mapply()`, ...
  
  * `Map()`, `Reduce()`
  
  * `Vectorize()`

--

&lt;br&gt;

* Embrace `map()` function and variants

  * `map()`, `map_dbl()`, `map_chr()`, `map_lgl()`, ...
  
  * `map2()`, `map2_dbl()`, `map2_chr()`, `map2_lgl()`, ...
  
  * `pmap()`, `pmap_dbl()`, `pmap_chr()`, `pmap_lgl()`, ...
  
  * `walk()`, `walk2()`, `pwalk()`, ...



---
## `map*()`


&lt;center&gt;
  &lt;img src="img/map.png", width=400&gt; 
&lt;/center&gt;

--

* `map()` applies the function to each element and returns a list.

--

* `map_lgl()`, `map_int()`, `map_dbl()` and `map_chr()` applies the function to each element and returns a atomic vector of the corresponding type.


---
## `map*()`





```r
map(1:5, rnorm)
```

```
  [[1]]
  [1] 1.370958
  
  [[2]]
  [1] -0.5646982  0.3631284
  
  [[3]]
  [1]  0.6328626  0.4042683 -0.1061245
  
  [[4]]
  [1]  1.51152200 -0.09465904  2.01842371 -0.06271410
  
  [[5]]
  [1]  1.3048697  2.2866454 -1.3888607 -0.2787888 -0.1333213
```

---
count: false
## `map*()`




```r
map(1:5, rnorm) %&gt;% 
  map_dbl(mean)
```

```
  [1]  1.3709584 -0.1007849  0.3103355  0.8431431  0.3581088
```

---
count: false
## `map*()`




```r
map(1:100, rnorm) %&gt;% 
  map_dbl(mean) %&gt;% 
  tibble(Mean = .) %&gt;% 
  mutate(N = row_number()) # Slightly ifferent from rownames_to_column("N")
```

```
  # A tibble: 100 x 2
        Mean     N
       &lt;dbl&gt; &lt;int&gt;
   1  1.37       1
   2 -0.101      2
   3  0.310      3
   4  0.843      4
   5  0.358      5
   6 -0.622      6
   7 -0.185      7
   8  0.0243     8
   9 -0.612      9
  10  0.314     10
  # ... with 90 more rows
```


---
count: false
## `map*()`




```r
map(1:100, rnorm) %&gt;% 
  map_dbl(mean) %&gt;% 
  tibble(Mean = .) %&gt;% 
  mutate(N = row_number()) %&gt;% 
  ggplot(aes(x = N, y = Mean)) +
  geom_hline(yintercept = 0, color = "red", alpha = 0.5) +
  geom_line()
```

&lt;img src="Modeling_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## A better way with `compose()` and `map_df()`


```r
mean_rnorm &lt;- compose(tibble, mean, rnorm)
mean_rnorm(5)
```

```
  # A tibble: 1 x 1
       out
     &lt;dbl&gt;
  1 -0.345
```

--


```r
map_df(1:10, mean_rnorm) %&gt;% rownames_to_column("N")
```

```
  # A tibble: 10 x 2
     N         out
     &lt;chr&gt;   &lt;dbl&gt;
   1 1      0.109 
   2 2     -0.199 
   3 3      0.244 
   4 4      0.0207
   5 5     -0.444 
   6 6      0.112 
   7 7     -0.374 
   8 8     -0.718 
   9 9      0.315 
  10 10    -0.0891
```


---
## `map*()`


&lt;center&gt;
  &lt;img src="img/map-arg.png", width=400&gt; 
&lt;/center&gt;


--




```r
map(1:4, rnorm, n = 6)
```

```
  [[1]]
  [1] 2.3709584 0.4353018 1.3631284 1.6328626 1.4042683 0.8938755
  
  [[2]]
  [1] 3.511522 1.905341 4.018424 1.937286 3.304870 4.286645
  
  [[3]]
  [1] 1.6111393 2.7212112 2.8666787 3.6359504 2.7157471 0.3435446
  
  [[4]]
  [1] 1.559533 5.320113 3.693361 2.218692 3.828083 5.214675
```

---
## `map*()`


&lt;center&gt;
  &lt;img src="img/map-list.png", width=400&gt; 
&lt;/center&gt;

--




```r
map(1:4, rnorm, n = 6) %&gt;% 
  map_dbl(function(x) x[2])
```

```
  [1] 0.4353018 1.9053410 2.7212112 5.3201133
```

---
count: false
## `map*()`


&lt;center&gt;
  &lt;img src="img/map-list.png", width=400&gt; 
&lt;/center&gt;




```r
map(1:4, rnorm, n = 6) %&gt;% 
  map_dbl(~ .[2])
```

```
  [1] 0.4353018 1.9053410 2.7212112 5.3201133
```

---
count: false
## `map*()`


&lt;center&gt;
  &lt;img src="img/map-list.png", width=400&gt; 
&lt;/center&gt;




```r
map(1:4, rnorm, n = 6) %&gt;% 
  map_dbl(2)
```

```
  [1] 0.4353018 1.9053410 2.7212112 5.3201133
```


---
## Why `map()` is better 

.footnote[&lt;a href="https://colinfay.me/happy-dev-purrr/" target="_blank"&gt;<i class="fas  fa-edit "></i> Happy dev with {purrr} (C.Fay)&lt;/a&gt;]

* Stable and consistent grammar


```r
apply(X, MARGIN, FUN, ...)
lapply(X, FUN, ...)
sapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE)
tapply(X, INDEX, FUN = NULL, ..., default = NA, simplify = TRUE)
mapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE, USE.NAMES = TRUE)
eapply(env, FUN, ..., all.names = FALSE, USE.NAMES = TRUE)
...
```

--

VS 


```r
map(.x, .f, ...)
map_if(.x, .p, .f, ...)
map_chr(.x, .f, ...)
map_int(.x, .f, ...)
map_dbl(.x, .f, ...)
...
```


---
count: false
## Why `map()` is better 

.footnote[&lt;a href="https://colinfay.me/happy-dev-purrr/" target="_blank"&gt;<i class="fas  fa-edit "></i> Happy dev with {purrr} (C.Fay)&lt;/a&gt;]

* Stable and consistent grammar

* Type stability



```r
sapply(iris$Sepal.Length, as.data.frame) %&gt;% class()
```

```
  [1] "list"
```

```r
sapply(iris$Sepal.Length, as.numeric) %&gt;% class()
```

```
  [1] "numeric"
```

--

VS 


```r
map_dfr(iris$Sepal.Length, as.data.frame) %&gt;% class()
```

```
  [1] "data.frame"
```

```r
map_dbl(iris$Sepal.Length, as.numeric) %&gt;% class()
```

```
  [1] "numeric"
```

---
count: false
## Why `map()` is better 

.footnote[&lt;a href="https://colinfay.me/happy-dev-purrr/" target="_blank"&gt;<i class="fas  fa-edit "></i> Happy dev with {purrr} (C.Fay)&lt;/a&gt;]

* Stable and consistent grammar

* Type stability

* Anonymous functions &amp; verbosity



```r
lapply(list, function(x) x + 2)
mapply(function(x, y) x + y, list1, list2)
lapply(list, function(x) x[2])
lapply(list, function(x) x$foo)
```

--

VS 


```r
map(list, ~ . + 2)
map2(list1, list2, ~ .x + .y)
map(list, 2)
map(list, "foo")
```


---
count: false
## Why `map()` is better 

.footnote[&lt;a href="https://colinfay.me/happy-dev-purrr/" target="_blank"&gt;<i class="fas  fa-edit "></i> Happy dev with {purrr} (C.Fay)&lt;/a&gt;]

* Stable and consistent grammar

* Type stability

* Anonymous functions &amp; verbosity

* But it's slightly slower... (~ 40 ns per element)


---
## `map2*()`


&lt;center&gt;
  &lt;img src="img/map2.png", width=400&gt; 
&lt;/center&gt;


`map2()` and `map2_*()` are variants of `map()` and `map_*()` which work with two arguments.

---
## `map2*()`

&lt;center&gt;
  &lt;img src="img/map2-arg.png", width=400&gt; 
&lt;/center&gt;

--


```r
map2(1:4, c(2, 5, 5, 10), runif, n = 5)
```

```
  [[1]]
  [1] 1.970967 1.618838 1.333427 1.346748 1.398485
  
  [[2]]
  [1] 4.354078 2.116809 4.246386 4.031830 2.513793
  
  [[3]]
  [1] 3.522176 4.028826 4.351215 4.965634 4.519089
  
  [[4]]
  [1] 7.398931 9.098138 5.136844 5.627720 8.968951
```


---
## `pmap*()`


&lt;center&gt;
  &lt;img src="img/pmap-3.png", width=400&gt; 
&lt;/center&gt;


`pmap()` and `pmap_*()` are generalized versions of `map()` and `map_*()` which work with any number of arguments.

---
## `pmap*()`



```r
pmap(list(n = c(2, 3, 2, 5), min = 1:4, max = c(2, 5, 5, 10)), runif)
```

```
  [[1]]
  [1] 1.693205 1.240545
  
  [[2]]
  [1] 2.128966 2.421437 2.649156
  
  [[3]]
  [1] 3.958797 3.394821
  
  [[4]]
  [1] 8.316135 4.047308 6.252940 7.086446 4.009423
```

---
## `*walk*()` functions 


&lt;center&gt;
  &lt;img src="img/walk.png", width=300&gt; 
&lt;/center&gt;

`walk()` and variants are designed for side-effects function and return the input.

---
## `imap*()` functions 


```r
swiss %&gt;%
  map(., function(x) {
    ggplot(., aes(Fertility, x)) + 
      geom_point()
    }) %&gt;%
  imap( ~ .x + labs(x = "Fertility", y = .y)) %&gt;%
  .[-1] %&gt;%
  gridExtra::grid.arrange(grobs = .)
```

&lt;img src="Modeling_files/figure-html/unnamed-chunk-27-1.png" width="720" style="display: block; margin: auto;" /&gt;


```r
swiss %&gt;%
  rownames_to_column() %&gt;%
  map(., function(x) {
    ggplot(., aes(rowname, x)) +
      geom_point() +
      theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
  }) %&gt;%
  imap( ~ .x + labs(x = NULL, y = .y)) %&gt;%
  .[-1] %&gt;%
  gridExtra::grid.arrange(grobs = .)
```

&lt;img src="Modeling_files/figure-html/unnamed-chunk-28-1.png" width="720" style="display: block; margin: auto;" /&gt;


---
## `reduce()`


&lt;center&gt;
  &lt;img src="img/reduce.png", width=400&gt; 
&lt;/center&gt;

`reduce(list(x1, x2, x3), f)` is equivalent to `f(f(x1, x2), x3)` 

---
## `reduce()`




```r
rerun(4, sample(1:10, 6)) 
```

```
  [[1]]
  [1] 3 4 5 7 2 8
  
  [[2]]
  [1] 10  6  9  1  2  7
  
  [[3]]
  [1]  7  4 10  9  5  6
  
  [[4]]
  [1]  4  7  8  2 10  1
```

--





```r
rerun(4, sample(1:10, 6)) %&gt;% 
  reduce(intersect)
```


---
count: false
## `reduce()`




```r
rerun(4, sample(1:10, 6))
```

```
  [[1]]
  [1] 3 4 5 7 2 8
  
  [[2]]
  [1] 10  6  9  1  2  7
  
  [[3]]
  [1]  7  4 10  9  5  6
  
  [[4]]
  [1]  4  7  8  2 10  1
```




```r
rerun(4, sample(1:10, 6)) %&gt;% 
  reduce(intersect)
```

```
  [1] 7
```




---
class: center, middle, inverse

&lt;br&gt;
# Tibble

&lt;img src="img/hex-tibble.png", width=270&gt; 

---
## Nice printing


```r
mtcars
```

```
                       mpg cyl  disp  hp drat    wt  qsec vs am gear carb
  Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
  Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
  Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
  Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
  Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
  Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
  Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
  Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
  Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
  Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
  Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
  Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
  Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
  Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
  Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
  Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
  Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
  Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
  Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
  Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
  Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
  Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
  AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
  Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
  Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
  Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
  Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
  Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
  Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
  Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
  Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
  Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
```

---
count: false
## Nice printing


```r
as_tibble(mtcars)
```

```
  # A tibble: 32 x 11
       mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
   1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
   2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
   3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
   4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
   5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
   6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
   7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
   8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
   9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
  10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
  # ... with 22 more rows
```

---
count: false
## Nice printing ... but don't use row names!


```r
as_tibble(mtcars, rownames = "model")
```

```
  # A tibble: 32 x 12
     model   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
     &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
   1 Mazd…  21       6  160    110  3.9   2.62  16.5     0     1     4     4
   2 Mazd…  21       6  160    110  3.9   2.88  17.0     0     1     4     4
   3 Dats…  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
   4 Horn…  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
   5 Horn…  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
   6 Vali…  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
   7 Dust…  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
   8 Merc…  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
   9 Merc…  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
  10 Merc…  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
  # ... with 22 more rows
```

---
## Consistancy in subsetting


```r
class(iris[, 1:2])
```

```
  [1] "data.frame"
```

--


```r
class(iris[, 1])
```

---
count: false
## Consistancy in subsetting


```r
class(iris[, 1:2])
```

```
  [1] "data.frame"
```


```r
class(iris[, 1])
```

```
  [1] "numeric"
```

--
&lt;br&gt;


```r
iris_tbl &lt;- as_tibble(iris)
class(iris_tbl[, 1:2])
```

```
  [1] "tbl_df"     "tbl"        "data.frame"
```



```r
class(iris_tbl[, 1])
```

```
  [1] "tbl_df"     "tbl"        "data.frame"
```

---
class: center, middle, noslidenumber, nologo

&lt;img src="img/tibble_kiddo.png", width=400&gt; 

---
## A little function


```r
divisors &lt;- function(N){
  if(N == 1) {return(1)}
  if(N == 2) {return(1:2)}
  c(1, (2:(N/2))[N %% 2:(N/2) == 0], N)
}
```



```r
map(4:8, divisors)
```

```
  [[1]]
  [1] 1 2 4
  
  [[2]]
  [1] 1 5
  
  [[3]]
  [1] 1 2 3 6
  
  [[4]]
  [1] 1 7
  
  [[5]]
  [1] 1 2 4 8
```


---
## List-columns


```r
tibble(N = 1:50)
```

```
  # A tibble: 50 x 1
         N
     &lt;int&gt;
   1     1
   2     2
   3     3
   4     4
   5     5
   6     6
   7     7
   8     8
   9     9
  10    10
  # ... with 40 more rows
```


---
count: false
## List-columns



```r
tibble(N = 1:50) %&gt;% 
  mutate(Divisors = map(N, divisors))
```

```
  # A tibble: 50 x 2
         N Divisors 
     &lt;int&gt; &lt;list&gt;   
   1     1 &lt;dbl [1]&gt;
   2     2 &lt;int [2]&gt;
   3     3 &lt;dbl [2]&gt;
   4     4 &lt;dbl [3]&gt;
   5     5 &lt;dbl [2]&gt;
   6     6 &lt;dbl [4]&gt;
   7     7 &lt;dbl [2]&gt;
   8     8 &lt;dbl [4]&gt;
   9     9 &lt;dbl [3]&gt;
  10    10 &lt;dbl [4]&gt;
  # ... with 40 more rows
```


---
count: false
## List-columns



```r
tibble(N = 1:50) %&gt;% 
  mutate(Divisors = map(N, divisors)) %&gt;% 
  pull(Divisors)
```

```
  [[1]]
  [1] 1
  
  [[2]]
  [1] 1 2
  
  [[3]]
  [1] 1 3
  
  [[4]]
  [1] 1 2 4
  
  [[5]]
  [1] 1 5
  
  [[6]]
  [1] 1 2 3 6
  
  [[7]]
  [1] 1 7
  
  [[8]]
  [1] 1 2 4 8
  
  [[9]]
  [1] 1 3 9
  
  [[10]]
  [1]  1  2  5 10
  
  [[11]]
  [1]  1 11
  
  [[12]]
  [1]  1  2  3  4  6 12
  
  [[13]]
  [1]  1 13
  
  [[14]]
  [1]  1  2  7 14
  
  [[15]]
  [1]  1  3  5 15
  
  [[16]]
  [1]  1  2  4  8 16
  
  [[17]]
  [1]  1 17
  
  [[18]]
  [1]  1  2  3  6  9 18
  
  [[19]]
  [1]  1 19
  
  [[20]]
  [1]  1  2  4  5 10 20
  
  [[21]]
  [1]  1  3  7 21
  
  [[22]]
  [1]  1  2 11 22
  
  [[23]]
  [1]  1 23
  
  [[24]]
  [1]  1  2  3  4  6  8 12 24
  
  [[25]]
  [1]  1  5 25
  
  [[26]]
  [1]  1  2 13 26
  
  [[27]]
  [1]  1  3  9 27
  
  [[28]]
  [1]  1  2  4  7 14 28
  
  [[29]]
  [1]  1 29
  
  [[30]]
  [1]  1  2  3  5  6 10 15 30
  
  [[31]]
  [1]  1 31
  
  [[32]]
  [1]  1  2  4  8 16 32
  
  [[33]]
  [1]  1  3 11 33
  
  [[34]]
  [1]  1  2 17 34
  
  [[35]]
  [1]  1  5  7 35
  
  [[36]]
  [1]  1  2  3  4  6  9 12 18 36
  
  [[37]]
  [1]  1 37
  
  [[38]]
  [1]  1  2 19 38
  
  [[39]]
  [1]  1  3 13 39
  
  [[40]]
  [1]  1  2  4  5  8 10 20 40
  
  [[41]]
  [1]  1 41
  
  [[42]]
  [1]  1  2  3  6  7 14 21 42
  
  [[43]]
  [1]  1 43
  
  [[44]]
  [1]  1  2  4 11 22 44
  
  [[45]]
  [1]  1  3  5  9 15 45
  
  [[46]]
  [1]  1  2 23 46
  
  [[47]]
  [1]  1 47
  
  [[48]]
   [1]  1  2  3  4  6  8 12 16 24 48
  
  [[49]]
  [1]  1  7 49
  
  [[50]]
  [1]  1  2  5 10 25 50
```


---
count: false
## List-columns



```r
tibble(N = 1:50) %&gt;% 
  mutate(Divisors = map(N, divisors),
         NbDivisors = map(Divisors, length)) 
```

--


```
  # A tibble: 50 x 3
         N Divisors  NbDivisors
     &lt;int&gt; &lt;list&gt;    &lt;list&gt;    
   1     1 &lt;dbl [1]&gt; &lt;int [1]&gt; 
   2     2 &lt;int [2]&gt; &lt;int [1]&gt; 
   3     3 &lt;dbl [2]&gt; &lt;int [1]&gt; 
   4     4 &lt;dbl [3]&gt; &lt;int [1]&gt; 
   5     5 &lt;dbl [2]&gt; &lt;int [1]&gt; 
   6     6 &lt;dbl [4]&gt; &lt;int [1]&gt; 
   7     7 &lt;dbl [2]&gt; &lt;int [1]&gt; 
   8     8 &lt;dbl [4]&gt; &lt;int [1]&gt; 
   9     9 &lt;dbl [3]&gt; &lt;int [1]&gt; 
  10    10 &lt;dbl [4]&gt; &lt;int [1]&gt; 
  # ... with 40 more rows
```


---
count: false
## List-columns



```r
tibble(N = 1:50) %&gt;% 
  mutate(Divisors = map(N, divisors),
         NbDivisors = map_dbl(Divisors, length)) 
```

```
  # A tibble: 50 x 3
         N Divisors  NbDivisors
     &lt;int&gt; &lt;list&gt;         &lt;dbl&gt;
   1     1 &lt;dbl [1]&gt;          1
   2     2 &lt;int [2]&gt;          2
   3     3 &lt;dbl [2]&gt;          2
   4     4 &lt;dbl [3]&gt;          3
   5     5 &lt;dbl [2]&gt;          2
   6     6 &lt;dbl [4]&gt;          4
   7     7 &lt;dbl [2]&gt;          2
   8     8 &lt;dbl [4]&gt;          4
   9     9 &lt;dbl [3]&gt;          3
  10    10 &lt;dbl [4]&gt;          4
  # ... with 40 more rows
```



---
count: false
## List-columns



```r
tibble(N = 1:50) %&gt;% 
  mutate(Divisors = map(N, divisors),
         NbDivisors = map_dbl(Divisors, length)) %&gt;% 
  ggplot(aes(x = N, y = NbDivisors)) +
  geom_col(aes(fill = NbDivisors &lt; 3), color = "grey30") +
  scale_fill_viridis_d(begin = 0.6) +
  labs(x = "N", y = "Number of divisors of N") +
  theme(legend.position = "none")
```

&lt;img src="Modeling_files/figure-html/listcolumnplot-1.png" width="720" style="display: block; margin: auto;" /&gt;

---
# `nest()`


```r
iris %&gt;% 
  as_tibble()
```

```
  # A tibble: 150 x 5
     Sepal.Length Sepal.Width Petal.Length Petal.Width Species
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
   1          5.1         3.5          1.4         0.2 setosa 
   2          4.9         3            1.4         0.2 setosa 
   3          4.7         3.2          1.3         0.2 setosa 
   4          4.6         3.1          1.5         0.2 setosa 
   5          5           3.6          1.4         0.2 setosa 
   6          5.4         3.9          1.7         0.4 setosa 
   7          4.6         3.4          1.4         0.3 setosa 
   8          5           3.4          1.5         0.2 setosa 
   9          4.4         2.9          1.4         0.2 setosa 
  10          4.9         3.1          1.5         0.1 setosa 
  # ... with 140 more rows
```

---
count:false
# `nest()`


```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  summarise(N = n())
```

```
  # A tibble: 3 x 2
    Species        N
    &lt;fct&gt;      &lt;int&gt;
  1 setosa        50
  2 versicolor    50
  3 virginica     50
```

---
count:false
# `nest()`


```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest()
```

```
  # A tibble: 3 x 2
    Species    data             
    &lt;fct&gt;      &lt;list&gt;           
  1 setosa     &lt;tibble [50 × 4]&gt;
  2 versicolor &lt;tibble [50 × 4]&gt;
  3 virginica  &lt;tibble [50 × 4]&gt;
```

---
count:false
# `nest()`


```r
iris %&gt;% 
  group_by(Species) %&gt;% 
  nest() %&gt;% 
  pull(data) %&gt;% 
  first()
```

```
  # A tibble: 50 x 4
     Sepal.Length Sepal.Width Petal.Length Petal.Width
            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
   1          5.1         3.5          1.4         0.2
   2          4.9         3            1.4         0.2
   3          4.7         3.2          1.3         0.2
   4          4.6         3.1          1.5         0.2
   5          5           3.6          1.4         0.2
   6          5.4         3.9          1.7         0.4
   7          4.6         3.4          1.4         0.3
   8          5           3.4          1.5         0.2
   9          4.4         2.9          1.4         0.2
  10          4.9         3.1          1.5         0.1
  # ... with 40 more rows
```








---
class: center, middle, inverse

&lt;br&gt;
# Tidymodels

&lt;img src="img/hex-tidymodels.png", width=270&gt; 

---
## Metapackage


```r
library(tidymodels)
```

```
  ── Attaching packages ─────────────────────────────────────────────────────────────── tidymodels 0.0.1 ──
```

```
  ✔ rsample   0.0.2     ✔ yardstick 0.0.2
  ✔ recipes   0.1.4     ✔ infer     0.4.0
  ✔ broom     0.5.0
```

```
  ── Conflicts ────────────────────────────────────────────────────────────────── tidymodels_conflicts() ──
  ✖ rsample::fill()    masks tidyr::fill()
  ✖ dplyr::filter()    masks stats::filter()
  ✖ recipes::fixed()   masks stringr::fixed()
  ✖ dplyr::lag()       masks stats::lag()
  ✖ recipes::prepper() masks rsample::prepper()
  ✖ yardstick::spec()  masks readr::spec()
  ✖ recipes::step()    masks stats::step()
  ✖ yardstick::tidy()  masks recipes::tidy(), broom::tidy()
```

--


```r
tidy &lt;- broom::tidy
```

---
class: center, middle, inverse

&lt;br&gt;
# Broom

&lt;img src="img/hex-broom.png", width=270&gt; 


---
## Dataset


```r
df_pins &lt;- read_table2("PINS.DON", 
                       col_names = c("variete", "diametre", "hauteur"))
df_pins
```

```
  # A tibble: 39 x 3
     variete diametre hauteur
     &lt;chr&gt;      &lt;dbl&gt;   &lt;int&gt;
   1 blanc       21.2     127
   2 blanc       20.2     119
   3 blanc       24.6     135
   4 blanc       23       132
   5 blanc       27.2     130
   6 blanc       18.6     130
   7 blanc       17.3     110
   8 blanc       10        75
   9 blanc       19.7     110
  10 blanc       22.3     124
  # ... with 29 more rows
```


---
## Classical output of linear regression


```r
reg_simple &lt;- lm(hauteur ~ diametre * variete, data = df_pins)
reg_simple
```

```
  
  Call:
  lm(formula = hauteur ~ diametre * variete, data = df_pins)
  
  Coefficients:
            (Intercept)               diametre           varietejaune  
                41.2747                 3.9789               -35.8390  
  diametre:varietejaune  
                 0.5293
```

---
count:false
## Classical output of linear regression


```r
reg_simple &lt;- lm(hauteur ~ diametre * variete, data = df_pins)
summary(reg_simple)
```

```
  
  Call:
  lm(formula = hauteur ~ diametre * variete, data = df_pins)
  
  Residuals:
       Min       1Q   Median       3Q      Max 
  -19.5014  -8.2424  -0.7899   7.5008  28.3598 
  
  Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
  (Intercept)            41.2747     6.8238   6.049 6.66e-07 ***
  diametre                3.9789     0.3926  10.136 5.95e-12 ***
  varietejaune          -35.8390    10.5955  -3.382  0.00178 ** 
  diametre:varietejaune   0.5293     0.5899   0.897  0.37572    
  ---
  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
  
  Residual standard error: 11.36 on 35 degrees of freedom
  Multiple R-squared:  0.8744,	Adjusted R-squared:  0.8637 
  F-statistic: 81.25 on 3 and 35 DF,  p-value: 7.69e-16
```

---
count:false
## Classical output of linear regression


```r
reg_simple &lt;- lm(hauteur ~ diametre * variete, data = df_pins)
coef(summary(reg_simple))
```

```
                           Estimate Std. Error    t value     Pr(&gt;|t|)
  (Intercept)            41.2747285  6.8237545  6.0486831 6.661673e-07
  diametre                3.9789200  0.3925661 10.1356694 5.951760e-12
  varietejaune          -35.8390158 10.5955323 -3.3824649 1.781368e-03
  diametre:varietejaune   0.5292551  0.5898638  0.8972496 3.757164e-01
```

```r
coef(reg_simple)
```

```
            (Intercept)              diametre          varietejaune 
             41.2747285             3.9789200           -35.8390158 
  diametre:varietejaune 
              0.5292551
```

---
## `tidy()`

Presents the outputs of the model in a tibble.


```r
tidy(reg_simple)
```

```
  # A tibble: 4 x 5
    term                  estimate std.error statistic  p.value
    &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
  1 (Intercept)             41.3       6.82      6.05  6.66e- 7
  2 diametre                 3.98      0.393    10.1   5.95e-12
  3 varietejaune           -35.8      10.6      -3.38  1.78e- 3
  4 diametre:varietejaune    0.529     0.590     0.897 3.76e- 1
```

---
## `glance()` 

Returns summary informations about the model in a singe row tibble.


```r
glance(reg_simple)
```

```
  # A tibble: 1 x 11
    r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
  *     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
  1     0.874         0.864  11.4      81.2 7.69e-16     4  -148.  306.  314.
  # ... with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;
```

---
## `augment()` 

Adds information about each observation in the dataset.


```r
(augmented &lt;- augment(reg_simple, df_pins))
```

```
  # A tibble: 39 x 10
     variete diametre hauteur .fitted .se.fit  .resid   .hat .sigma .cooksd
   * &lt;chr&gt;      &lt;dbl&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
   1 blanc       21.2     127   126.     3.16   1.37  0.0775   11.5 3.32e-4
   2 blanc       20.2     119   122.     2.94  -2.65  0.0668   11.5 1.04e-3
   3 blanc       24.6     135   139.     4.13  -4.16  0.132    11.5 5.86e-3
   4 blanc       23       132   133.     3.64  -0.790 0.103    11.5 1.55e-4
   5 blanc       27.2     130   150.     4.98 -19.5   0.192    10.9 2.17e-1
   6 blanc       18.6     130   115.     2.65  14.7   0.0545   11.2 2.56e-2
   7 blanc       17.3     110   110.     2.52  -0.110 0.0491   11.5 1.27e-6
   8 blanc       10        75    81.1    3.47  -6.06  0.0935   11.5 8.10e-3
   9 blanc       19.7     110   120.     2.83  -9.66  0.0623   11.4 1.28e-2
  10 blanc       22.3     124   130.     3.45  -6.00  0.0921   11.5 7.81e-3
  # ... with 29 more rows, and 1 more variable: .std.resid &lt;dbl&gt;
```

---
## Graph of residuals


```r
augmented %&gt;% 
  arrange(.fitted) %&gt;% 
  mutate(.lowess = lowess(.fitted, .resid)[[2]]) %&gt;% 
  ggplot() +
  aes(x = .fitted) +
  geom_hline(yintercept = 0, alpha = 0.5, linetype = "dashed") +
  geom_line(aes(y = .lowess), color = "red") +
  geom_point(aes(y = .resid, color = variete)) +
  labs(x = "Fitted values", y = "Residuals")
```

&lt;img src="Modeling_files/figure-html/resid-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## Quantile-quantile plot


```r
ggplot(augmented) +
  aes(sample = .resid) +
  geom_qq_line(color = "red") +
  geom_qq()+
  labs(x = "Theoretical quantiles", y = "Standardized residuals")
```

&lt;img src="Modeling_files/figure-html/qq-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## Leverage


```r
augmented %&gt;% 
  arrange(.hat) %&gt;% 
  mutate(.lowess = lowess(.hat, .std.resid)[[2]]) %&gt;% 
  ggplot() +
  aes(x = .hat) +
  geom_vline(xintercept = 0, alpha = 0.5, linetype = "dashed") +
  geom_hline(yintercept = 0, alpha = 0.5, linetype = "dashed") +
  geom_line(aes(y = .lowess), color = "red") +
  geom_point(aes(y = .std.resid, color = variete)) +
  labs(x = "Leverage", y = "Standardized residuals")
```

&lt;img src="Modeling_files/figure-html/cook-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## Cook's distances


```r
augmented %&gt;% 
  rowid_to_column("ID") %&gt;% 
  ggplot() +
  aes(x = ID, y = .cooksd, fill = variete) +
  geom_col(color = "grey30") +
  labs(x = "Observation", y = "Cook's Distance")
```

&lt;img src="Modeling_files/figure-html/unnamed-chunk-65-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## Wilcoxon test


```r
w_test &lt;- wilcox.test(hauteur ~ variete, data = df_pins)
w_test
```

```
  
  	Wilcoxon rank sum test with continuity correction
  
  data:  hauteur by variete
  W = 269.5, p-value = 0.0241
  alternative hypothesis: true location shift is not equal to 0
```

--

&lt;br&gt;


```r
tidy(w_test)
```

```
  # A tibble: 1 x 4
    statistic p.value method                                     alternative
        &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                                      &lt;chr&gt;      
  1      270.  0.0241 Wilcoxon rank sum test with continuity co… two.sided
```

---
## Output for your package




---
class: center, middle, inverse

&lt;br&gt;
# Rsample

&lt;img src="img/hex-rsample.png", width=270&gt; 

---
## Quelques infos


---
## Estimation of parameters


```r
bootstrap_pins &lt;-
  df_pins %&gt;% 
  rowid_to_column("ID") %&gt;% 
  bootstraps(times = 500)
bootstrap_pins
```

```
  # Bootstrap sampling 
  # A tibble: 500 x 2
     splits       id          
     &lt;list&gt;       &lt;chr&gt;       
   1 &lt;S3: rsplit&gt; Bootstrap001
   2 &lt;S3: rsplit&gt; Bootstrap002
   3 &lt;S3: rsplit&gt; Bootstrap003
   4 &lt;S3: rsplit&gt; Bootstrap004
   5 &lt;S3: rsplit&gt; Bootstrap005
   6 &lt;S3: rsplit&gt; Bootstrap006
   7 &lt;S3: rsplit&gt; Bootstrap007
   8 &lt;S3: rsplit&gt; Bootstrap008
   9 &lt;S3: rsplit&gt; Bootstrap009
  10 &lt;S3: rsplit&gt; Bootstrap010
  # ... with 490 more rows
```

---
## `rsplit` object


```r
bootstrap_pins %&gt;% 
  pull(splits) %&gt;% 
  first()
```

```
  &lt;39/12/39&gt;
```

---
count:false
## `rsplit` object


```r
bootstrap_pins %&gt;% 
  pull(splits) %&gt;% 
  first() %&gt;% 
  as_tibble() 
```

```
  # A tibble: 39 x 4
        ID variete diametre hauteur
     &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;int&gt;
   1    11 blanc        5.6      55
   2    16 blanc       14.4     107
   3     1 blanc       21.2     127
   4    15 blanc       12.6     108
   5    34 jaune       12.2      57
   6    14 blanc       13.1     116
   7    19 blanc        7        56
   8    24 jaune       14.4      84
   9    20 blanc        9.3      70
  10     8 blanc       10        75
  # ... with 29 more rows
```

---
## Analysis &amp; assessment sets


```r
bootstrap_pins %&gt;% 
  pull(splits) %&gt;% 
  first() %&gt;% 
  as_tibble() %&gt;% # analysis()
  pull(ID) %&gt;% 
  table()
```

```
  .
   1  3  4  5  8 10 11 12 13 14 15 16 17 18 19 20 21 22 24 26 27 28 29 31 33 
   2  1  1  1  1  1  1  1  1  1  1  2  1  2  3  1  2  1  1  2  1  1  2  3  2 
  34 36 
   2  1
```

--


```r
bootstrap_pins %&gt;% 
  pull(splits) %&gt;% 
  first() %&gt;% 
  as_tibble(data = "assessment") %&gt;% # assessment()
  pull(ID) %&gt;% 
  table()
```

```
  .
   2  6  7  9 23 25 30 32 35 37 38 39 
   1  1  1  1  1  1  1  1  1  1  1  1
```

---
## Bootstrapped models


```r
my_lm &lt;- partial(lm, formula = hauteur ~ diametre * variete)
```

--


```r
(bootstrap_pins &lt;-
   bootstrap_pins %&gt;% 
   mutate(reg = map(splits, my_lm)))
```

```
  # Bootstrap sampling 
  # A tibble: 500 x 3
     splits       id           reg     
   * &lt;list&gt;       &lt;chr&gt;        &lt;list&gt;  
   1 &lt;S3: rsplit&gt; Bootstrap001 &lt;S3: lm&gt;
   2 &lt;S3: rsplit&gt; Bootstrap002 &lt;S3: lm&gt;
   3 &lt;S3: rsplit&gt; Bootstrap003 &lt;S3: lm&gt;
   4 &lt;S3: rsplit&gt; Bootstrap004 &lt;S3: lm&gt;
   5 &lt;S3: rsplit&gt; Bootstrap005 &lt;S3: lm&gt;
   6 &lt;S3: rsplit&gt; Bootstrap006 &lt;S3: lm&gt;
   7 &lt;S3: rsplit&gt; Bootstrap007 &lt;S3: lm&gt;
   8 &lt;S3: rsplit&gt; Bootstrap008 &lt;S3: lm&gt;
   9 &lt;S3: rsplit&gt; Bootstrap009 &lt;S3: lm&gt;
  10 &lt;S3: rsplit&gt; Bootstrap010 &lt;S3: lm&gt;
  # ... with 490 more rows
```

---
count: false
## Bootstrapped models


```r
my_lm &lt;- partial(lm, formula = hauteur ~ diametre * variete)
```


```r
(bootstrap_pins &lt;-
   bootstrap_pins %&gt;% 
   mutate(reg = map(splits, my_lm),
          tidied = map(reg, tidy)))
```

```
  # Bootstrap sampling 
  # A tibble: 500 x 4
     splits       id           reg      tidied          
   * &lt;list&gt;       &lt;chr&gt;        &lt;list&gt;   &lt;list&gt;          
   1 &lt;S3: rsplit&gt; Bootstrap001 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   2 &lt;S3: rsplit&gt; Bootstrap002 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   3 &lt;S3: rsplit&gt; Bootstrap003 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   4 &lt;S3: rsplit&gt; Bootstrap004 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   5 &lt;S3: rsplit&gt; Bootstrap005 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   6 &lt;S3: rsplit&gt; Bootstrap006 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   7 &lt;S3: rsplit&gt; Bootstrap007 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   8 &lt;S3: rsplit&gt; Bootstrap008 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
   9 &lt;S3: rsplit&gt; Bootstrap009 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
  10 &lt;S3: rsplit&gt; Bootstrap010 &lt;S3: lm&gt; &lt;tibble [4 × 5]&gt;
  # ... with 490 more rows
```


---
count: false
## Bootstrapped models


```r
my_lm &lt;- partial(lm, formula = hauteur ~ diametre * variete)
```


```r
(bootstrap_pins &lt;-
   bootstrap_pins %&gt;% 
   mutate(reg = map(splits, my_lm),
          tidied = map(reg, tidy)) %&gt;% 
   unnest(tidied)) 
```

```
  # A tibble: 2,000 x 6
     id           term                  estimate std.error statistic  p.value
     &lt;chr&gt;        &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
   1 Bootstrap001 (Intercept)             35.0       4.93      7.09  2.95e- 8
   2 Bootstrap001 diametre                 4.32      0.299    14.4   2.57e-16
   3 Bootstrap001 varietejaune           -37.0       8.26     -4.48  7.56e- 5
   4 Bootstrap001 diametre:varietejaune    0.387     0.516     0.750 4.58e- 1
   5 Bootstrap002 (Intercept)             49.6       6.64      7.47  9.53e- 9
   6 Bootstrap002 diametre                 3.68      0.394     9.32  5.19e-11
   7 Bootstrap002 varietejaune           -53.4       9.91     -5.38  5.00e- 6
   8 Bootstrap002 diametre:varietejaune    1.37      0.605     2.26  2.99e- 2
   9 Bootstrap003 (Intercept)             33.4       7.70      4.34  1.14e- 4
  10 Bootstrap003 diametre                 4.31      0.449     9.59  2.52e-11
  # ... with 1,990 more rows
```

---
## Bootstrapped models


```r
bootstrap_pins %&gt;% 
  mutate(term = fct_relevel(term, "diametre:varietejaune", after = Inf)) %&gt;%
  ggplot(aes(x = estimate, y = term, fill = term)) +
  ggridges::geom_density_ridges() + 
  theme(legend.position = "none")
```

&lt;img src="Modeling_files/figure-html/unnamed-chunk-78-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
class: center, middle, inverse

# References

---


### Purrr


* &lt;a href="https://stackoverflow.com/questions/45101045/why-use-purrrmap-instead-of-lapply/47123420" target="_blank"&gt;<i class="fab  fa-stack-overflow "></i> Why use purrr::map instead of lapply? (H. Wickham)&lt;/a&gt;



### Tibble

* &lt;a href="https://www.rstudio.com/resources/videos/using-list-cols-in-your-dataframe/" target="_blank"&gt;<i class="fas  fa-play-circle "></i> Putting square pegs in round holes: Using list-cols in your dataframe (J. Bryan)&lt;/a&gt;


### Tidymodels

* &lt;a href="https://static1.squarespace.com/static/51156277e4b0b8b2ffe11c00/t/5b75871e21c67c985a06f481/1534428959053/RPharma_18_Kuhn.pdf" target="_blank"&gt;<i class="fas  fa-clone "></i> Modeling in the Tidyverse (M. Kuhn)&lt;/a&gt;


---
class: center, middle, inverse
count:false

&lt;br&gt; 

# Thanks for you attention!

&lt;br&gt;

#### <i class="fab  fa-github "></i> &lt;a href="https://github.com/abichat" target="_blank"&gt;@abichat&lt;/a&gt;
&lt;div style = "margin-top: -10px"&gt;&lt;/div&gt;
#### <i class="fab  fa-twitter "></i> &lt;a href="https://twitter.com/_abichat" target="_blank"&gt;@_abichat&lt;/a&gt;
&lt;div style = "margin-top: -10px"&gt;&lt;/div&gt;
#### <i class="fab  fa-linkedin "></i> &lt;a href="https://www.linkedin.com/in/antoinebichat" target="_blank"&gt;antoinebichat&lt;/a&gt;
&lt;div style = "margin-top: -10px"&gt;&lt;/div&gt;
#### <i class="fas  fa-link "></i> &lt;a href="https://abichat.github.io" target="_blank"&gt;abichat.github.io&lt;/a&gt;
&lt;div style = "margin-top: -10px"&gt;&lt;/div&gt;
####<i class="fas  fa-envelope "></i> &lt;a href="mailto:antoine.bichat@mines-nancy.org?subject=SOTR"&gt;antoine.bichat@mines-nancy.org&lt;/a&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current% / %total%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
